{% extends "default.njk" %}

{% block seo %}
<title>{% if seo_title %}{{ seo_title }}{% else %}{{ title }}{% endif %}</title>

<link rel="canonical" href="{{ siteUrl }}/{{ slug }}/" />
<meta name="author" content="Jenish Jain" />
<meta name="description" content="{{ description }}" />
<meta name="keywords" content="{{ tags | join(', ') }}, engineering, tech blog, Jenish Jain{% if category == 'work-culture' %}, engineering at Rapido, Rapido{% endif %}" />
{% if image %}
<meta name="image" content="{{ image | cloudinary(page.inputPath, 1200) }}" />
{% else %}
<meta name="image" content="{{ title | seoImage }}" />
{% endif %}

<meta property="og:type" content="article" />
<meta property="og:url" content="{{ siteUrl }}/{{ slug }}/" />
<meta property="og:site_name" content="Jenish Jain's Engineering Blog" />
<meta property="og:description" content="{{ description }}" />
{% if image %}
<meta property="og:image" content="{{ image | cloudinary(page.inputPath, 1200) }}" />
{% else %}
<meta property="og:image" content="{{ title | seoImage }}" />
{% endif %}
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="article:published_time" content="{{ date | rssDate }}" />
<meta property="article:author" content="Jenish Jain" />
<meta property="article:section" content="{{ category }}" />
{% for tag in tags %}<meta property="article:tag" content="{{ tag }}" />
{% endfor %}

<meta name="twitter:dnt" content="on" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@jenishjain6" />
<meta name="twitter:title" content="{% if seo_title %}{{ seo_title }}{% else %}{{ title }}{% endif %}" />
<meta name="twitter:description" content="{{ description }}" />
{% if image %}
<meta name="twitter:image" content="{{ image | cloudinary(page.inputPath, 1200) }}" />
{% else %}
<meta name="twitter:image" content="{{ title | seoImage }}" />
{% endif %}
{% endblock %}

{% block main %}
<main>
  <article class="post">
    {% block heading %}
    <div class="heading">
      <h1>{{title}}</h1>
      <p class="lede">{{description}}</p>
    </div>
    {% endblock %}

    {% block details %}
    <div class="details">
      <figure class="author">
        <img
          src="https://res.cloudinary.com/jenishjain/image/upload/q_auto,f_auto,c_thumb,w_260,h_260,g_faces,z_0.55/v1700920184/portfolio/images/jenishjain-with-chopsticks.jpg"
          alt="Jenish Jain" />
        <figcaption>written by Jenish</figcaption>
      </figure>
    </div>
    {% endblock %}

    {% block sidebar %}
    <div class="sidebar">
      <div class="sticky-sidebar">
        <div class="newsletter-nudge">
          <p>
            Hey, friends! I share posts like these regularly in my
            newsletter.
            <strong
              >Sign up to get my best stuff direct to your inbox.</strong
            >
          </p>
          <a href="/newsletter/" class="button">I love stuff!</a>
        </div>

        <details class="table-of-contents" open>
          <summary>Table of Contents</summary>

          {{ content | toc | safe }}
        </details>
      </div>
    </div>
    <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
      data-id="jenishjain" data-description="Support me on Buy me a pizza!" data-message="Buy me a pizza!"
      data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
    {% endblock %}

    {% block content %}
    <div class="content">
      {{ content | safe }}
    </div>
    {% endblock %}
  </article>

  {# Related Posts Section - Below entire article #}
  {% set relatedPostsList = collections.posts | relatedPosts(slug, tags, 3) %}
  {% if relatedPostsList.length > 0 %}
  <aside class="related-posts" style="
    margin: 3rem auto 2rem;
    padding: 2.5rem 0 0;
    border-top: 3px solid #ffe742;
    max-width: 100%;
  ">
    <h2 style="
      font-size: 1.75rem;
      margin-bottom: 2rem;
      text-align: center;
      color: #171321;
    ">Continue Reading</h2>

    <div style="
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      justify-content: center;
      align-items: stretch;
    ">
      {% for post in relatedPostsList %}
      <article style="
        background: #fff;
        border: 2px solid #f0f0f0;
        border-radius: 6px;
        padding: 1.5rem;
        transition: all 0.3s ease;
        display: flex;
        flex-direction: column;
        flex: 1 1 280px;
        max-width: 320px;
        min-width: 260px;
      " onmouseover="this.style.borderColor='#ffe742'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(0,0,0,0.08)';" onmouseout="this.style.borderColor='#f0f0f0'; this.style.transform='translateY(0)'; this.style.boxShadow='none';">

        <h3 style="
          font-size: 1.1rem;
          margin: 0 0 0.75rem 0;
          line-height: 1.4;
          font-weight: 600;
          color: #171321;
        ">
          <a href="/{{ post.data.slug }}/" style="
            text-decoration: none;
            color: inherit;
            transition: color 0.2s;
          " onmouseover="this.style.color='#5F7FFF';" onmouseout="this.style.color='#171321';">
            {{ post.data.title }}
          </a>
        </h3>

        <p style="
          margin: 0 0 auto;
          color: #666;
          font-size: 0.9rem;
          line-height: 1.5;
          display: -webkit-box;
          -webkit-line-clamp: 2;
          -webkit-box-orient: vertical;
          overflow: hidden;
        ">
          {{ post.data.description }}
        </p>

        <div style="
          margin-top: 1rem;
          padding-top: 1rem;
          border-top: 1px solid #f0f0f0;
        ">
          <time style="font-size: 0.8rem; color: #999;">
            {{ post.date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) }}
          </time>
        </div>
      </article>
      {% endfor %}
    </div>
  </aside>
  {% endif %}
</main>
{% endblock %}

{% block scripts %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ title }}",
  "description": "{{ description }}",
  "author": {
    "@type": "Person",
    "name": "Jenish Jain",
    "url": "https://jenishjain.in",
    "sameAs": [
      "https://twitter.com/jenishjain6",
      "https://github.com/jenish-jain",
      "https://www.linkedin.com/in/jenish-jain"
    ]
  },
  "datePublished": "{{ date | rssDate }}",
  "dateModified": "{{ date | rssDate }}",
  {% if image %}
  "image": "{{ image | cloudinary(page.inputPath, 1200) }}",
  {% else %}
  "image": "{{ title | seoImage }}",
  {% endif %}
  "publisher": {
    "@type": "Person",
    "name": "Jenish Jain",
    "logo": {
      "@type": "ImageObject",
      "url": "https://res.cloudinary.com/jenishjain/image/upload/q_auto,f_auto,c_thumb,w_260,h_260,g_faces,z_0.55/v1700920184/portfolio/images/jenishjain-with-chopsticks.jpg"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ siteUrl }}/{{ slug }}/"
  },
  "keywords": "{{ tags | join(', ') }}, engineering, tech blog, Jenish Jain",
  "articleSection": "{{ category }}"
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://jenishjain.in"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "{{ siteUrl }}/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Posts",
      "item": "{{ siteUrl }}/posts/"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "{{ title }}",
      "item": "{{ siteUrl }}/{{ slug }}/"
    }
  ]
}
</script>

<script src="/scripts/post.min.js"></script>
{% endblock %}
