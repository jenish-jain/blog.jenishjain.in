{% extends "default.njk" %}

{% block seo %}
<title>{% if seo_title %}{{ seo_title }}{% else %}{{ title }}{% endif %}</title>

<link rel="canonical" href="{{ siteUrl }}/{{ slug }}/" />
<meta name="author" content="Jenish Jain" />
<meta name="description" content="{{ description }}" />
<meta name="keywords" content="{{ tags | join(', ') }}, engineering, tech blog, Jenish Jain{% if category == 'work-culture' %}, engineering at Rapido, Rapido{% endif %}" />
{% if image %}
<meta name="image" content="{{ image | cloudinary(page.inputPath, 1200) }}" />
{% else %}
<meta name="image" content="{{ title | seoImage }}" />
{% endif %}

<meta property="og:type" content="article" />
<meta property="og:url" content="{{ siteUrl }}/{{ slug }}/" />
<meta property="og:site_name" content="Jenish Jain's Engineering Blog" />
<meta property="og:description" content="{{ description }}" />
{% if image %}
<meta property="og:image" content="{{ image | cloudinary(page.inputPath, 1200) }}" />
{% else %}
<meta property="og:image" content="{{ title | seoImage }}" />
{% endif %}
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="article:published_time" content="{{ date | rssDate }}" />
<meta property="article:author" content="Jenish Jain" />
<meta property="article:section" content="{{ category }}" />
{% for tag in tags %}<meta property="article:tag" content="{{ tag }}" />
{% endfor %}

<meta name="twitter:dnt" content="on" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@jenishjain6" />
<meta name="twitter:title" content="{% if seo_title %}{{ seo_title }}{% else %}{{ title }}{% endif %}" />
<meta name="twitter:description" content="{{ description }}" />
{% if image %}
<meta name="twitter:image" content="{{ image | cloudinary(page.inputPath, 1200) }}" />
{% else %}
<meta name="twitter:image" content="{{ title | seoImage }}" />
{% endif %}
{% endblock %}


{% block details %}
<div class="details">
  <figure class="author">
    <img
      src="https://res.cloudinary.com/jenishjain/image/upload/q_auto,f_auto,c_thumb,w_260,h_260,g_faces,z_0.55/v1700920184/portfolio/images/jenishjain-with-chopsticks.jpg"
      alt="Jenish Jain" />
    <figcaption>written by Jenish</figcaption>
  </figure>
</div>
{% endblock %}

{% block sidebar %}
<div class="sidebar">
  <div class="sticky-sidebar">
    <div class="newsletter-nudge">
      <p>
        Hey, friends! I share posts like these regularly in my
        newsletter.
        <strong
          >Sign up to get my best stuff direct to your inbox.</strong
        >
      </p>
      <a href="/newsletter/" class="button">I love stuff!</a>
    </div>

    <details class="table-of-contents" open>
      <summary>Table of Contents</summary>

      {{ content | toc | safe }}
    </details>
  </div>
</div>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
  data-id="jenishjain" data-description="Support me on Buy me a pizza!" data-message="Buy me a pizza!"
  data-color="#5F7FFF" data-position="Right" data-x_margin="18" data-y_margin="18"></script>
{% endblock %}

{% block content %}
{{ super() }}

{# Related Posts Section #}
{% set relatedPostsList = collections.posts | relatedPosts(slug, tags, 3) %}
{% if relatedPostsList.length > 0 %}
<aside class="related-posts" style="margin-top: 4rem; padding-top: 2rem; border-top: 2px solid #ffe742;">
  <h2 style="font-size: 2rem; margin-bottom: 1.5rem;">Related Posts</h2>
  <div style="display: grid; gap: 1.5rem;">
    {% for post in relatedPostsList %}
    <article style="display: flex; gap: 1rem; align-items: start;">
      <div style="flex: 1;">
        <h3 style="font-size: 1.5rem; margin: 0 0 0.5rem 0;">
          <a href="/{{ post.data.slug }}/" style="text-decoration: none; color: inherit;">
            {{ post.data.title }}
          </a>
        </h3>
        <p style="margin: 0; color: #666; font-size: 0.95rem;">
          {{ post.data.description }}
        </p>
        <p style="margin-top: 0.5rem; font-size: 0.85rem; color: #888;">
          Posted on {{ post.date | rssDate }}
        </p>
      </div>
    </article>
    {% endfor %}
  </div>
</aside>
{% endif %}
{% endblock %}

{% block scripts %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": "{{ title }}",
  "description": "{{ description }}",
  "author": {
    "@type": "Person",
    "name": "Jenish Jain",
    "url": "https://jenishjain.in",
    "sameAs": [
      "https://twitter.com/jenishjain6",
      "https://github.com/jenish-jain",
      "https://www.linkedin.com/in/jenish-jain"
    ]
  },
  "datePublished": "{{ date | rssDate }}",
  "dateModified": "{{ date | rssDate }}",
  {% if image %}
  "image": "{{ image | cloudinary(page.inputPath, 1200) }}",
  {% else %}
  "image": "{{ title | seoImage }}",
  {% endif %}
  "publisher": {
    "@type": "Person",
    "name": "Jenish Jain",
    "logo": {
      "@type": "ImageObject",
      "url": "https://res.cloudinary.com/jenishjain/image/upload/q_auto,f_auto,c_thumb,w_260,h_260,g_faces,z_0.55/v1700920184/portfolio/images/jenishjain-with-chopsticks.jpg"
    }
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ siteUrl }}/{{ slug }}/"
  },
  "keywords": "{{ tags | join(', ') }}, engineering, tech blog, Jenish Jain",
  "articleSection": "{{ category }}"
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Home",
      "item": "https://jenishjain.in"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "Blog",
      "item": "{{ siteUrl }}/"
    },
    {
      "@type": "ListItem",
      "position": 3,
      "name": "Posts",
      "item": "{{ siteUrl }}/posts/"
    },
    {
      "@type": "ListItem",
      "position": 4,
      "name": "{{ title }}",
      "item": "{{ siteUrl }}/{{ slug }}/"
    }
  ]
}
</script>

<script src="/scripts/post.min.js"></script>
{% endblock %}
